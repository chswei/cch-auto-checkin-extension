# 醫師出勤管理系統自動打卡 - 瀏覽器擴充功能

## 安裝擴充功能

1. 下載此資料夾的[壓縮檔](https://github.com/chswei/cch-auto-checkin-extension/archive/refs/heads/main.zip)後，解壓縮成 `auto-checkin-extension` 資料夾
2. 開啟瀏覽器
3. 網址列輸入 `chrome://extensions/`
4. 開啟右上角的「開發人員模式」
5. 點擊「載入未封裝項目」
6. 選擇 `auto-checkin-extension` 資料夾
7. 擴充功能將會出現在擴充功能列表中
8. 安裝好後，請「不要」將此s資料夾刪除

## 使用方法

### 1. 登入彰基EIP系統
- 手動登入 https://dpt.cch.org.tw/EIP/#/Login
- 進入到打卡頁面：頁面左上 Menu → 住院醫師排班資訊 → 打卡補登作業

### 2. 使用擴充功能
1. 確保您在正確的打卡頁面 https://dpt.cch.org.tw/EIP/#/Main/Resident/MonthSettlement
2. 點擊瀏覽器工具列上的擴充功能圖示
3. 點擊**值班**按鈕，然後在日曆上點擊值班日（顯示藍色背景和「值」字）
4. 點擊**請假**按鈕，然後在日曆上點擊請假日（顯示紅色背景和「假」字）。
   - **請先確認請假日已跑完假單流程，否則系統會報錯**
   - 如果該月一號是 PM off，也請選擇**請假**，系統就不會打這天的卡
5. 點擊**加班**按鈕，然後在日曆上點擊加班日（顯示橙色背景和「加」字）
6. 自動統計延長總工時（值班日 3 小時/次，加班日 2 小時/次）
7. 點擊「開始自動打卡」按鈕
8. 系統即會自動處理所有打卡步驟，無需手動點擊，整個打卡流程應可在兩分鐘內結束

## 排班邏輯說明

### 班別自動判斷
- **一般平日**：使用 C02 班別（08:00-17:30）
- **加班平日**：使用 C02 班別（08:00-20:00）
- **一般週六**：使用 W02 班別（08:00-12:00）  
- **平日值班**：使用 DW2 班別（08:00-隔日12:00）
- **週日值班**：使用 DW6 班別（08:00-隔日12:00）

### 自動跳過、不打卡的情況
- **值班隔日**：值班日的隔天自動跳過
- **請假日**：手動選擇的請假日跳過
- **週日值班前週六**：如果週日值班，前一天週六跳過

### 加班日特殊邏輯
- **選擇限制**：僅允許選擇週一到週五作為加班日，週末會自動禁用
- **值班限制**：值班日的隔天無法選擇為加班日，系統會自動禁用並提示
- **互斥選擇**：同一天不能同時是值班日、請假日和加班日
- **自動清理**：選擇值班日時，如隔天已設為加班日會自動清除
- **視覺提示**：不可選的加班日會顯示為灰色
- **時間調整**：加班日自動將 C02 班別的簽退時間從 17:30 調整為 20:00

## 技術架構
```
auto-checkin-extension/
├── manifest.json       # Chrome擴充功能設定檔
├── popup.html          # 彈出視窗使用者介面
├── popup.css           # 介面樣式
├── popup.js            # 介面邏輯和事件處理
├── utils.js            # 日期計算和排班規則工具
├── content.js          # 網頁DOM操作自動化腳本
└── dialog-override.js  # 對話框自動處理腳本
```

## 免責聲明
此工具僅用於簡化重複性作業，使用者應：
- 自行承擔使用風險
- 確認生成的排班表正確性
- 遵守醫院相關規定